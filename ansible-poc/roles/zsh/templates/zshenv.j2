# .zshenv - Generated by Ansible
# Sourced for all zsh sessions (interactive, non-interactive, login, non-login)
# This file is loaded before .zshrc
# All PATH modifications should be centralized here

# Function to add directories to PATH without duplicates
add_to_path() {
    if [[ -d "$1" ]] && [[ ":$PATH:" != *":$1:"* ]]; then
        export PATH="$1:$PATH"
    fi
}

# Function to append directories to PATH without duplicates
append_to_path() {
    if [[ -d "$1" ]] && [[ ":$PATH:" != *":$1:"* ]]; then
        export PATH="$PATH:$1"
    fi
}

{% if ansible_os_family == "Darwin" %}
# Homebrew (macOS)
{% if ansible_architecture == "arm64" %}
# Apple Silicon
if [[ -d "/opt/homebrew/bin" ]]; then
    add_to_path "/opt/homebrew/bin"
    add_to_path "/opt/homebrew/sbin"
fi
{% else %}
# Intel Mac
if [[ -d "/usr/local/bin" ]]; then
    add_to_path "/usr/local/bin"
fi
{% endif %}
{% else %}
# Linux - standard paths
if [[ -d "/usr/local/bin" ]]; then
    add_to_path "/usr/local/bin"
fi
{% endif %}

# Local bin directories
add_to_path "$HOME/.local/bin"
add_to_path "$HOME/bin"

# Development tool paths
# pyenv
if [[ -d "$HOME/.pyenv/bin" ]]; then
    export PYENV_ROOT="$HOME/.pyenv"
    add_to_path "$PYENV_ROOT/bin"
fi

# Cargo (Rust)
if [[ -d "$HOME/.cargo/bin" ]]; then
    add_to_path "$HOME/.cargo/bin"
fi

# Go
if [[ -d "$HOME/go/bin" ]]; then
    add_to_path "$HOME/go/bin"
fi

# Ruby gems
if [[ -d "$HOME/.gem/ruby" ]]; then
    latest_ruby=$(find "$HOME/.gem/ruby" -maxdepth 1 -type d -name "[0-9]*.[0-9]*" 2>/dev/null | sort -V | tail -1)
    if [[ -n "$latest_ruby" ]]; then
        add_to_path "$latest_ruby/bin"
    fi
fi

# Windsurf (Codeium)
if [[ -d "$HOME/.codeium/windsurf/bin" ]]; then
    add_to_path "$HOME/.codeium/windsurf/bin"
fi
